


public class broker_message_parsing {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		
		
		String mssg="0010111101111111101101100010111001011101110101111110100011011100000010010100000010001011110101101101110011010111011001111100111010100001000111111001100101100111011110101000111000000011110010011111110100011110100110111000001000111100101000110010111100011100001010011101111001001100010001010110111110001111000111101111010011000010100100110100100011001110011011010010000110100011111110001110010111100101000111111101101101001011101110000011000010000011111010010010100101010011010110011110001010000100111000100111001101010110000010001010011000000110101000010001101010101010110111100101000111010000110101011010000000111010010010010110111110010011101101111101000001111011000010011111110011100111111010010001110011111100110001101101111110110110100010101110101010110101011110111110010110001001100000110100001001101010011110000100001111010110100000000111001001011100010100011101100010010011110001011011001000110000010111101000111010111001000011000101101110001110111001001000011000011000100110110100101111001101101010001111100110001010100011001111101100000101101100111011111110101111011101100100101110011010111001000000110100011011110101010000101001001111011011111011011011000110010011100100110111000110101111011111111010111010111111111101111100100000001111001001110010100101110010110100110110111100101110011000011000101100000000010100111010110000100101101010111110001011110011110010110101111110111111000010011001011001111011100110001001100011101011101101111010110011100111101101010111010111001011010001011001110011011111100110010001000001011111010110000111110101100111110001101001001101000011111111010100110000110010010001001110110110101000010111100000000110001110110011001111111001111011000000111000110010100000001111011100010000001011100101101010001110111001011001000010000101100101110011111000100010111001110000001001111101111110010100101110100011001100110111000011010111101000101001101000001100111000111111111111100101110111000011111010011110011000110111000000110111000001101111010001011110100111100111110010111000000111011100001101100110010011110110000100110100010111111010100101011011001101101000011110111011101110000100001100101010110111111101110111100110000101101111000111111110010010000000100010010111011001011101011001000101011101000110011011111111010101001100110010101110001011010001101010111100011011101010011010010010110110011110000101100101001110000011101101011001100111000100011111111110011110000001010101100101010100110000100001001010101011111111001001010111010000110000111010110110001010000000101011101010110001011001100110111011011100111100110111000001101110011100011101011011101101101110011100100101001010110100010110011101001100010011000001101100110010010010111101000000111110000011111110010001101010010110000000010111110100101011010011110110100001111001000100000101111100100110000010010010111011111001111110010000000011110010110100111011100111111100110111010111100101101011001110101000011111100111100011010111111000101100100011001010110000010010101010110100110001001001101111111110111010000110110111101111000011111010010100001011100101111110010010110000011000011110100110100000001101001101110101011111110110110010111101100100011000100111011111110010101010010100100110000000001101110000000011110000111010101001111101000111000000100010010000110111000100100101010011001000111000111001011101110001000001011000000110011000111010111110010010110011100100000111100101100100011100011110101111110000000101111011010101111100010111010011110001111000110110101011011001010101101001111001011000001000101011011111101101101010101001001100000010111000011000001001010101101100101010110001110100101000101011101100111000011000010110010000001010110100110010111110111010101011000100111100101010100011100100011111110110111001110011111010110000111110000101100001001000001101111110010110100110110010111110110110110010101001111010010010010011110111011110110011100001000101110101111110101101011011100110010100110111000101000100000010010000001011110011011011100111110111011101011011101011101100110101010100101010110110100001000100101011001110000010000001000000011000000010101110101001100100111010110010010111111010010101010100110101100101111110011010001010110110010000100001100111111111000111000010000000011000000010000000111110000100110011101000001100111001101100011111001010110101011000011000001011110010011011001111110000010011001010111110110111000000001000110000110011011111011000011011011011111100010100110100111011000000101110101100000100110101011110101010100110111100101100011101100110001110110110110100010100111011011011100001010111010000000100010011011010001011011101000111001000001100000111100100011000111010111101101100001010100011100101010010111110110000000011101011110011101101010010000100110110100010110111001011000111101100101100101111110110000110101111011100000010111111110001101110101100111101000011001110010011001001010100000011101000100010000011000110001100110001100010011011111111111010001010000100010101011100110011000100111001011101111111110010000110101000110100001100100110100011111110110111100100001101000101110000011000001111101111111001011100110011010111100000000000000100110011100110101011101111011000101010111000011010111100001101010101010110001101111000011011011011110000001111101101001111101111111010011101010101011001011000100101011010001001010100000110001000001001111001010001100110100001111011000100000000000001101011010101000010110011011101100111000000011111111011100100011010110111001011110010100001001100011110011110011100100011011011011100011110111101101010100011110110001010001011001101110001101101010010010110100110111110000010010100101010100011100010110101100111011110101001011000101111110111000101101111000111000000101010010001101000011111011100010001011100110100111000001100010100001010010011110001100100000010101101101001111110101100111110001100101100110001101101000000001001110001011010001011001001010010011000001000010111011001011101000100100101101010000110101111001111110000000101000011101110011011001111100001101110111011110100101001110001011001011001100010011011110001010001001111110111100111110011101110100100011000101100101011111101010011110110110101010100111000101100111001001100000000100011101000111101011101010110110010000010101100111000110110010000001100111011110000010011110101010010001110011000111101000110101110000001101101001110111110100000111110100000010101100100011101100000011001101100110001000010000101000110010000011010010110001101001101011110100111001110101110100111101111000101011011010000111011100101001111011110000100111100101111101111110011011001111110101010111110100111001110100101000000110100001110100110010000101001111110111011001111110111000001001101100111110100110000110000111011110000111100101110101001100101101001110110001101110010000111101010111001110101001011110111011011000101001101010010011101011101000011000001000111111111011001101001101001110101101000100111110010110111110110010011101101110011001001110010100011010101111010000110101010110010100101010101101000010010111011100010111101000000110100100101110101010100001110111110010101110111100101000100011010010111010011111011110110101110010001011011001110101101111100110010000100011011001001111111010011011010010000001001011011100001001111111101000100010111010011100100011100110001001010000101010111001101110011011110001100101111011010011100111101111000001101000111000010100101100101011111000111100110101100001101010110000111011100111011010110110111110100000111110011100000100110100010111011111001001011101101101001100101100001001101110101101100010000010101001011000010110011111110010100101001001110001100100100110000010010111010110100111110101000000111110100111110010001000110011000011011000001010001010101100100100010101101101011110100110001010111110010011111101000000001111000001100101001100100110001011010010000110000011011010111100001101001111000010101110001101100001011010000011011001111111111110100001101011100110101010011100010100111000010111111100101101001101101001010011101101110001010000111011111101001100100011001000010100100001010000101010111010010000000011100011111100000110011100101011110110000100100010011001101100000101001111001101000011111001110011010111011110111101011000010101000111101001110110111000110010010011111110101101011110010000101101011010101101011111011111110100111011010001000001101110010110001011010001110100000011110100001101101010111010100011111011000000010011011110011001101100011011000001010001101100100101010110000000001110011011010011110011100001101011110001101001101001001001001000111101011101100111110000111100111110111011001111010101011111100001000010001110101110111111001010010101110010001110100000110111101011111101011011011000110011000110000101100000001001100111110000000011010010010101101011110101000100110001010101111111110101110001110000000101101010001000001111110000010010100100111101010001100010101101010111110110111010011001011111100001000000010111101100110101011110111101111011000111010011010100001101110111000001011000111010101101010111010100010110111000011100001100010111101010110100111001100010010111101110001011111010101001001101000001101000001010001001100001100101011111111001000111010101101001110111110101011011010101101010100011101101110010101111101010110011111001101010001100001100001100100000011110101100010111101111100001110011101110111101101011111010010000101110111000110010100011101111101101110101010101001000010100000110101010111011010000011110011101000110111011011001000101011011000001110101011001111110001100010110011010010011100010100010111100100000011101110001101010110000000011011111110001010111111111011111110110100101100100000100110101010110110001011010101110010011011000010011110111010000000111000100110 bloomfilter 04/11/2016 05/11/2016 1000 0.01";
		
		
		String[] parsed_mssg=mssg.split(" ");
		String bloomfilterbits=parsed_mssg[0];
		String topic=parsed_mssg[1];
		String sd=parsed_mssg[2];
		String ed=parsed_mssg[3];
		String no_elements=parsed_mssg[4];
		int n=Integer.parseInt(no_elements);
		
		
		
		String falseProbability=parsed_mssg[5];
		double p=Double.parseDouble(falseProbability);
		
		
		
		System.out.println("***************** parsed components of received message");
		
		System.out.println("bloomfilter bits="+bloomfilterbits);
		System.out.println("topic="+topic);
		System.out.println("sd="+sd);
		System.out.println("ed="+ed);
		System.out.println("n="+ed);
		System.out.println("p="+ed);
		
		System.out.println("***************** parsed components of received message");
		
		System.out.println("converting into bloom filter object");
		CreateBloomFilter bf=new CreateBloomFilter(n,p);
		bf.putdata(bloomfilterbits);
		String tocheck="random string2";
		System.out.println("now checking the memebership of string");
		System.out.println("result of checking is ="+bf.contains(tocheck));
	}

}
